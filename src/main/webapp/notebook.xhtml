<f:view xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
  xmlns:pm="http://primefaces.org/mobile"
  contentType="text/html" encoding="utf-8">

  <h:head>
    <meta charset="utf-8" />
    <meta http-equiv="refresh" content="#{session.maxInactiveInterval};url=#{request.getContextPath()}/mobile/pf_viewExpired.jsf" />
  </h:head>

    <pm:page title="#{msgs['NOTEBOOK_PAGE_TITLE']}">
        <f:facet name="postinit">
          <h:outputStylesheet library="primefaces-mobile"
            name="calendar/calendar.css" />
          <h:outputScript library="primefaces-mobile"
            name="calendar/calendar.js" />
        </f:facet>

    <!-- Main View -->
        <pm:view id="mainView" swatch="e">
            <pm:header title="#{msgs['MAIN_VIEW_TITLE']}">
                <f:facet name="right">
                  <p:commandButton value="#{msgs['NEW']}" icon="plus" action="#{noteBook.initNew}" />
                </f:facet>
            </pm:header>
            <pm:content>
                <h:form id="listNotesForm">
                    <p:dataList id="notesList" value="#{noteBook.notes}" var="note" type="inset">
                        <p:column>
                            <p:commandLink value="#{note.text}" update=":editNoteForm" action="pm:editNoteView">
                                <f:setPropertyActionListener value="#{note}" target="#{noteBook.note}" />
                            </p:commandLink>
                        </p:column>
                    </p:dataList>
                </h:form>
            </pm:content>
        </pm:view>
        
        

        <!-- Edit Note View -->
        <pm:view id="editNoteView" swatch="e">
            <pm:header title="#{msgs['EDIT_MESSAGE']}" >
              <f:facet name="left">
                <p:button value="#{msgs['BACK']}" icon="back" onclick="PrimeFaces.back()" />
              </f:facet>
            </pm:header>

            <pm:content>
                <h:form id="editNoteForm">
                    <p:inputTextarea id="noteText" value="#{noteBook.note.text}" />
                    <p:calendar value="#{noteBook.note.receivingDate}" mode="inline"  
                    	pattern="MMM/dd/yyyy"  mindate="#{noteBook.minDate}" maxdate="#{noteBook.maxDate}" />
                    <p:separator />
                    <p:commandButton value="#{msgs['SAVE']}" actionListener="#{noteBook.save}" 
                      update="noteText :listNotesForm:notesList" icon="check" oncomplete="PrimeFaces.back()" />
                </h:form>
            </pm:content>
        </pm:view>
        

    </pm:page>

</f:view>
